@namespace tauri_browser.Components.Browser

<div class="toolbar">
    <div class="nav-controls" style="display: flex; gap: 4px;">
        <button class="nav-btn" @onclick="OnBack" disabled="@(!CanGoBack)" title="Geri">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 20px; height: 20px;">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
            </svg>
        </button>
        <button class="nav-btn" @onclick="OnForward" disabled="@(!CanGoForward)" title="İleri">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 20px; height: 20px;">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
        </button>
        <button class="nav-btn" @onclick="OnRefresh" title="Yenile">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 20px; height: 20px;">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
            </svg>
        </button>
    </div>

    <div class="url-container" style="flex-grow: 1; margin: 0 8px;">
        <input type="text" class="url-input" 
               value="@CurrentUrl"
               @onchange="@((ChangeEventArgs e) => OnUrlChanged(e.Value?.ToString()))"
               @onkeyup="HandleKeyUp" 
               placeholder="Web adresini girin veya arama yapın..." />
    </div>

    <div class="window-controls">
        <!-- Settings button placeholder -->
         <button class="nav-btn" title="Ayarlar">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 20px; height: 20px;">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
        </button>
    </div>
</div>

@code {
    [Parameter] public string CurrentUrl { get; set; } = "";
    [Parameter] public bool CanGoBack { get; set; }
    [Parameter] public bool CanGoForward { get; set; }
    [Parameter] public bool IsLoading { get; set; }
    
    [Parameter] public EventCallback OnBack { get; set; }
    [Parameter] public EventCallback OnForward { get; set; }
    [Parameter] public EventCallback OnRefresh { get; set; }
    [Parameter] public EventCallback<string> OnNavigate { get; set; }

    private string _tempUrl = "";

    protected override void OnParametersSet()
    {
        _tempUrl = CurrentUrl;
    }

    private void OnUrlChanged(string? newValue)
    {
        _tempUrl = newValue ?? "";
    }

    private async Task HandleKeyUp(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            await OnNavigate.InvokeAsync(_tempUrl);
        }
    }
}
